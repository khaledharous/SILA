<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registration</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #457B9D, #A8DADC, #1D3557);
        }

        .form-container {
            width: 95%;
            max-width: 900px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        h1 {
            text-align: center;
            font-size: 2rem;
            color: #1D3557;
            margin-bottom: 25px;
        }

        form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        label {
            font-size: 0.95rem;
            color: #333;
            margin-bottom: 6px;
            display: block;
        }

        input,
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            background-color: #f9f9f9;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        input:hover,
        select:hover {
            background-color: #f1f1f1;
        }

        input:focus,
        select:focus {
            border-color: #457B9D;
            outline: none;
            box-shadow: 0 0 8px rgba(69, 123, 157, 0.5);
        }

        input.error,
        select.error {
            border-color: #e63946;
            box-shadow: 0 0 5px rgba(230, 57, 70, 0.5);
        }

        input.success,
        select.success {
            border-color: #2A9D8F;
            box-shadow: 0 0 5px rgba(42, 157, 143, 0.5);
        }

        .error-message {
            color: #e63946;
            font-size: 0.9rem;
            margin-top: 0.3rem;
            display: block;
        }

        button {
            grid-column: 1 / -1;
            padding: 15px;
            background: #1D3557;
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        .account-option {
            grid-column: 1 / -1;
            text-align: center;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .account-option a {
            color: #1D3557;
            font-weight: bold;
            text-decoration: none;
        }

        .account-option a:hover {
            text-decoration: underline;
        }

        .messages {
            grid-column: 1 / -1;
            margin-bottom: 15px;
            text-align: center;
        }

        .flash-message {
            padding: 10px;
            border-radius: 5px;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .flash-message.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .flash-message.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>

<body>
    <div class="form-container">
        <h1>Enter your personal information</h1>

        <!-- Flash messages -->
        <div class="messages">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            {% for category, message in messages %}
            <div class="flash-message {{ category }}">{{ message }}</div>
            {% endfor %}
            {% endif %}
            {% endwith %}
        </div>

        <form id="registrationForm" action="/register" method="POST">
            <div>
                <label for="username">Username</label>
                <input type="text" id="username" name="username" placeholder="Enter your Username" required />
            </div>
            <div>
                <label for="dateofbirth">Date of Birth</label>
                <input type="date" id="dateofbirth" name="dateofbirth" required />
                <div id="dob-error" class="error-message" aria-live="polite"></div>
            </div>

            <div>
                <label for="studentid">Student ID</label>
                <input type="text" id="studentid" name="studentid" placeholder="Enter your Student ID" required />
                <div id="studentid-error" class="error-message" aria-live="polite"></div>
            </div>

            <div>
                <label for="section">Section</label>
                <input type="text" id="section" name="section" placeholder="Enter your Section" required />
            </div>

            <div>
                <label for="academic_year">Choose your academic year:</label>
                <select id="academic_year" name="academic_year" required>
                    <optgroup label="License">
                        <option value="1 Year License">1 Year License</option>
                        <option value="2 Year License">2 Year License</option>
                        <option value="3 Year License">3 Year License</option>
                    </optgroup>
                    <optgroup label="Master">
                        <option value="1 Year Master">1 Year Master</option>
                        <option value="2 Year Master">2 Year Master</option>
                    </optgroup>
                </select>
            </div>

            <div>
                <label for="address">Address</label>
                <input type="text" id="address" name="address" placeholder="Enter your Address" required />
            </div>

            <div>
                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="name@example.com" required />
                <div id="email-error" class="error-message" aria-live="polite"></div>
            </div>

            <div>
                <label for="city">City</label>
                <input type="text" id="city" name="city" placeholder="Enter your City" required />
            </div>

            <div>
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter your Password" required />
                <small id="password-warning" style="display: none;">Password must be at least 8 characters!</small>
            </div>

            <div>
                <label for="confirm-password">Confirm Password</label>
                <input type="password" id="confirm-password" name="confirm-password" placeholder="Confirm your Password"
                    required />
            </div>

            <button type="submit" id="signup-button">Sign Up</button>

            <div class="account-option">
                Already have an account? <a href="{{ url_for('login') }}">Sign In</a>
            </div>
        </form>
    </div>

    <script>
        // Validation for Date of Birth
        const dobInput = document.getElementById('dateofbirth');
        const dobError = document.getElementById('dob-error');
        const today = new Date();
        const minDate = "1950-01-01";
        const sixteenYearsAgo = new Date();
        sixteenYearsAgo.setFullYear(today.getFullYear() - 16);
        const maxDate = sixteenYearsAgo.toISOString().split('T')[0];
        dobInput.setAttribute('max', maxDate);
        dobInput.setAttribute('min', minDate);

        dobInput.addEventListener('input', function () {
            const value = this.value;
            let error = "";

            if (!value) {
                error = "Date of birth is required.";
                this.classList.add('error');
                this.classList.remove('success');
            } else if (value > maxDate) {
                error = "You must be at least 16 years old.";
                this.classList.add('error');
                this.classList.remove('success');
            } else if (value < minDate) {
                error = "Date must be after 1950.";
                this.classList.add('error');
                this.classList.remove('success');
            } else {
                this.classList.remove('error');
                this.classList.add('success');
                error = "";
            }

            dobError.textContent = error;
        });

        // Validation for Student ID
        const studentIdInput = document.getElementById('studentid');
        const studentIdError = document.getElementById('studentid-error');
        studentIdInput.addEventListener('input', function () {
            const value = this.value.trim();
            const isValid = /^\d{12}$/.test(value);

            if (!value) {
                studentIdError.textContent = "Student ID is required.";
                this.style.borderColor = "#e63946";
            } else if (!isValid) {
                studentIdError.textContent = "Student ID must be exactly 12 digits.";
                this.style.borderColor = "#e63946";
            } else {
                studentIdError.textContent = "";
                this.style.borderColor = "#2A9D8F";
            }
        });

        // Password Validation
        const passwordInput = document.getElementById('password');
        const passwordWarning = document.getElementById('password-warning');
        passwordInput.addEventListener('input', function () {
            if (this.value.length < 8) {
                passwordWarning.style.display = "block";
                this.style.borderColor = "#e63946";
            } else {
                passwordWarning.style.display = "none";
                this.style.borderColor = "#2A9D8F";
            }
        });

        // Validation for Address
        const addressInput = document.getElementById('address');
        addressInput.addEventListener('input', function () {
            if (this.value.trim()) {
                this.classList.remove('error');
                this.classList.add('success');
            } else {
                this.classList.add('error');
                this.classList.remove('success');
            }
        });

        // Validation for Confirm Password
        const confirmPasswordInput = document.getElementById('confirm-password');
        confirmPasswordInput.addEventListener('input', function () {
            if (this.value === passwordInput.value) {
                this.classList.remove('error');
                this.classList.add('success');
            } else {
                this.classList.add('error');
                this.classList.remove('success');
            }
        });
    </script>
</body>

</html>